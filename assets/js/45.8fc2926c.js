(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{399:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"один-класс-одна-задача"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#один-класс-одна-задача"}},[t._v("#")]),t._v(" Один класс, одна задача")]),t._v(" "),a("p",[t._v("Действия Laravel предоставляют новую «единицу жизни» в Вашем приложении: "),a("strong",[t._v("Действие")]),t._v(".")]),t._v(" "),a("p",[t._v("Это побуждает Вас сосредоточиться на том, что на самом деле делает Ваше приложение, а не на шаблонах фреймворка, на которые оно опирается.")]),t._v(" "),a("h2",{attrs:{id:"конкретно-что-такое-деиствие"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#конкретно-что-такое-деиствие"}},[t._v("#")]),t._v(" Конкретно, что такое действие?")]),t._v(" "),a("p",[t._v("Действие может быть любым PHP-классом с методом "),a("code",[t._v("handle")]),t._v(". Просто добавьте к этому классу трейт "),a("code",[t._v("AsAction")]),t._v(" - и вуаля, у Вас есть действие.")]),t._v(" "),a("p",[t._v("У него есть только одно ограничение: "),a("strong",[t._v("он должен иметь возможность разрешать из контейнера")]),t._v(" - это означает, что приложение "),a("code",[t._v("app(MyAction::class)")]),t._v(" не должно завершаться ошибкой.")]),t._v(" "),a("p",[t._v("Это означает, что Вы можете использовать конструктор для внедрения зависимостей в свои действия.")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Lorisleiva"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Actions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Concerns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("AsAction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyFirstAction")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("AsAction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" MyInjectedService "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("__construct")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyInjectedService "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("service")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$someArguments")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ваша логика действий здесь...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("small",[t._v("Обратите внимание, что в Laravel Actions используется трейт вместо наследования, чтобы быть максимально ненавязчивым. Если Вы предпочитаете наследование, Вы можете использовать эквивалент "),a("code",[t._v("extends \\Lorisleiva\\Actions\\Action")]),t._v('. Если Вы не предпочитаете наследование, Вас может заинтересовать "'),a("a",{attrs:{href:"./granular-traits"}},[t._v("Более детально о трейтах")]),t._v('".')])]),t._v(" "),a("h2",{attrs:{id:"запуск-как-объект"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#запуск-как-объект"}},[t._v("#")]),t._v(" Запуск как объект")]),t._v(" "),a("p",[t._v("Поскольку у Вас есть полный контроль над своими классами действий, Вам действительно не нужны Laravel Actions, чтобы запускать их как объект.")]),t._v(" "),a("p",[t._v("Однако Laravel Actions предоставляет Вам два вспомогательных статических метода: "),a("code",[t._v("make")]),t._v(" и "),a("code",[t._v("run")]),t._v(". Это облегчает Вам "),a("strong",[t._v("создание экземпляра")]),t._v(" и "),a("strong",[t._v("выполнение")]),t._v(" Вашего действия соответственно.")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Эквивалентно "app(MyFirstAction::class)".')]),t._v("\nMyFirstAction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Эквивалентно "MyFirstAction::make()->handle($myArguments)".')]),t._v("\nMyFirstAction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$myArguments")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("Рекомендуется использовать эти методы для создания экземпляра действия, чтобы оно всегда разрешалось из контейнера. Таким образом:")]),t._v(" "),a("ul",[a("li",[t._v("Всегда можно использовать инъекцию зависимостей в конструкторе.")]),t._v(" "),a("li",[t._v('Можно заменить действие макетом в тестах (смотрите раздел "'),a("a",{attrs:{href:"./mock-and-test"}},[t._v("Макет и проверка действий")]),t._v('").')])]),t._v(" "),a("h2",{attrs:{id:"рекомендуемые-условные-обозначения"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#рекомендуемые-условные-обозначения"}},[t._v("#")]),t._v(" Рекомендуемые условные обозначения")]),t._v(" "),a("p",[t._v("Несмотря на то, что у Вас есть полный контроль над тем, как реализовать свои действия, несколько незначительных соглашений могут помочь Вам оставаться последовательными при организации Вашего приложения. Вот два рекомендуемых.")]),t._v(" "),a("h3",{attrs:{id:"начни-с-глагола"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#начни-с-глагола"}},[t._v("#")]),t._v(" Начни с глагола")]),t._v(" "),a("p",[t._v("Назовите свои классы действий "),a("strong",[t._v("маленькими явными предложениями, начинающимися с глагола")]),t._v(". Например, действие, которое «отправляет электронное письмо пользователю для сброса пароля», может называться "),a("code",[t._v("SendResetPasswordEmail")]),t._v(".")]),t._v(" "),a("p",[t._v("Таким образом, Ваша структура папок становится почти исчерпывающим словарем всего, что предоставляет Ваше приложение. Это подводит нас ко второму рекомендуемому соглашению.")]),t._v(" "),a("h3",{attrs:{id:"используите-папку-actions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#используите-папку-actions"}},[t._v("#")]),t._v(" Используйте папку "),a("code",[t._v("Actions")])]),t._v(" "),a("p",[t._v("Создайте папку "),a("code",[t._v("app/Actions")]),t._v(" и сгруппируйте свои действия внутри этой папки по темам. Вот простой пример.")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("app/\n├── Actions/\n│   ├── Authentication/\n│   │   ├── LoginUser.php\n│   │   ├── RegisterUser.php\n│   │   ├── ResetUserPassword.php\n│   │   └── SendResetPasswordEmail.php\n│   ├── Leads/\n│   │   ├── BulkRemoveLead.php\n│   │   ├── CreateNewLead.php\n│   │   ├── GetLeadDetails.php\n│   │   ├── MarkLeadAsCustomer.php\n│   │   ├── MarkLeadAsLost.php\n│   │   ├── RemoveLead.php\n│   │   ├── SearchLeadsForUser.php\n│   │   └── UpdateLeadDetails.php\n│   └── Settings/\n│       ├── GetUserSettings.php\n│       ├── UpdateUserAvatar.php\n│       ├── UpdateUserDetails.php\n│       ├── UpdateUserPassword.php\n│       └── DeleteUserAccount.php\n├── Models/\n└── ...\n")])])]),a("p",[t._v("В качестве альтернативы, если Ваше приложение уже разделено на темы или модули, Вы можете создать папку "),a("code",[t._v("Actions")]),t._v(" под каждым из этих модулей. Например:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("app/\n├── Authentication/\n│   ├── Actions/\n│   ├── Models/\n│   └── ...\n├── Leads/\n│   ├── Actions/\n│   ├── Models/\n│   └── ...\n└── Settings/\n    ├── Actions/\n    └── ...\n")])])]),a("h2",{attrs:{id:"как-это-работает"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#как-это-работает"}},[t._v("#")]),t._v(" Как это работает?")]),t._v(" "),a("p",[t._v("До сих пор мы видели только, как запускать действия как объекты, но Вам может быть интересно, как Ваши классы будут выполняться как контроллеры, задания и т. д.")]),t._v(" "),a("p",[t._v("Laravel Actions делает это, добавляя в контейнер специальный перехватчик, который распознает, как выполняется класс. Когда это происходит - и это важная часть - "),a("strong",[t._v("он оборачивает Ваш PHP-класс в декоратор, который будет делегировать Ваше действие, когда это необходимо")]),t._v(". У каждого шаблона проектирования есть собственный декоратор - например, "),a("code",[t._v("ControllerDecorator")]),t._v(", "),a("code",[t._v("JobDecorator")]),t._v(" и так далее. Это означает, что Вы по-прежнему полностью контролируете свой PHP-класс и Вам не нужно беспокоиться о конфликте между различными шаблонами проектирования.")]),t._v(" "),a("p",[t._v('Посетите страницу "'),a("a",{attrs:{href:"./how-does-it-work"}},[t._v("Как это работает?")]),t._v('" если Вы хотите узнать об этом больше.')]),t._v(" "),a("p",[t._v("Теперь перейдем к "),a("a",{attrs:{href:"./register-as-controller"}},[t._v("контроллерам")]),t._v(".")])])}),[],!1,null,null,null);s.default=e.exports}}]);